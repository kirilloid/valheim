import {
  Piece,
  DamageModifiers,
  MaterialType,
  CraftingStation,
  ItemType,
  EntityId,
  mods,
} from '../types';

const damageModifiersElementalPart = {
  fire: 'immune',
  frost: 'immune',
  lightning: 'normal',
  poison: 'immune',
  spirit: 'immune',
} as const;

const damageModifiersFireplace: DamageModifiers = {
  blunt: 'normal',
  slash: 'normal',
  pierce: 'normal',
  chop: 'normal',
  pickaxe: 'normal',
  ...damageModifiersElementalPart,
};

const damageModifieresExtensions: DamageModifiers = mods([0, 0, 1, 2, 0, 0, 1, 0, 3, 3]);

const damageModifiersWood: DamageModifiers = {
  blunt: 'normal',
  slash: 'normal',
  pierce: 'resistant',
  chop: 'weak',
  pickaxe: 'normal',
  fire: 'normal',
  frost: 'normal',
  lightning: 'normal',
  poison: 'immune',
  spirit: 'immune',
};

const damageModifiersCooking: DamageModifiers = mods([0, 0, 1, 0, 0, 1, 0, 0, 3, 3]);

const notOnWood = true;
const onlyOnFlat = true;
const notOnFloor = true;
// const nonRepairable = true;
// const nonRemovable = true;
const allowedInDungeons = true;
const groundOnly = true;

const requiresRoof = true;
const requiresFire = true;
const providesSupport = true;

const wearStructure = (
  hp: number,
  damageModifiers: DamageModifiers,
  materialType: MaterialType | undefined,
  { noRoof = true, noSupport = true }: { noRoof?: boolean, noSupport?: boolean } = {},
) => ({
  hp,
  damageModifiers,
  noRoof,
  noSupport,
  providesSupport: true,
  materialType,
});

const woodResist: DamageModifiers = mods([0, 0, 1, 2, 0, 0, 0, 0, 3, 3]);
const darkwoodResist: DamageModifiers = mods([0, 0, 1, 2, 1, 2, 0, 0, 3, 3]);
const stoneResist: DamageModifiers = mods([0, 0, 0, 0, 2, 1, 1, 0, 3, 3]);
const chestResist: DamageModifiers = mods([1, 1, 1, 1, 1, 1, 1, 0, 3, 3]);
const ironResist: DamageModifiers = mods([0, 0, 1, 0, 1, 1, 1, 3, 3, 3]);
const craftStationResist: DamageModifiers = mods([1, 1, 1, 1, 0, 3, 3, 0, 3, 3]);

const woodStructureWear = wearStructure(400, woodResist, MaterialType.Wood);
const darkwoodStructureWear = wearStructure(400, darkwoodResist, MaterialType.Wood);
const woodRoofStructureWear = { ...woodStructureWear, noRoof: false };
const stoneStructureWear = wearStructure(1500, stoneResist, MaterialType.Stone, { noRoof: false });

const woodStructureRecipe = (wood: number, type: 'Wood' | 'RoundLog' | 'FineWood' = 'Wood'): Piece['recipe'] =>
  ({ type: 'craft_piece', materials: { [type]: wood }, station: CraftingStation.Workbench, });

const stoneStructureRecipe = (stone: number): Piece['recipe'] =>
  ({ type: 'craft_piece', materials: { Stone: stone }, station: CraftingStation.StoneCutter, });

const darkwoodStructureRecipe = (materials: Record<EntityId, number>): Piece['recipe'] =>
  ({ type: 'craft_piece', materials, station: CraftingStation.Workbench });

const ironStructureRecipe = (iron: number): Piece['recipe'] =>
  ({ type: 'craft_piece', materials: { Iron: iron }, station: CraftingStation.Forge });

const craftingStationIds = {
//  [CraftingStation.Inventory]: 'Hands'
} as Record<CraftingStation, EntityId>;

export function getCraftingStationId(id: CraftingStation): EntityId {
  return craftingStationIds[id];
}

type StructuralIntegrity = {
  maxSupport: number;
  minSupport: number;
  verticalLoss: number;
  horizontalLoss: number;
};

const durabilityTable: Record<MaterialType, StructuralIntegrity> = {
  [MaterialType.Wood]: {
    maxSupport: 100,
    minSupport: 10,
    verticalLoss: 1/8,
    horizontalLoss: 1/5,
  },
  [MaterialType.Stone]: {
    maxSupport: 1000,
    minSupport: 100,
    verticalLoss: 1/8,
    horizontalLoss: 1,
  },
  [MaterialType.Iron]: {
    maxSupport: 1500,
    minSupport: 20,
    verticalLoss: 1/13,
    horizontalLoss: 1/13,
  },
  [MaterialType.HardWood]: {
    maxSupport: 140,
    minSupport: 10,
    verticalLoss: 1/10,
    horizontalLoss: 1/6,
  },
};

export function getStructuralIntegrity(material: MaterialType): StructuralIntegrity {
  return durabilityTable[material];
}

export const pieces: Piece[] = [
  { id: 'fire_pit',
    base: true,
    type: 'piece',
    subtype: 'fireplace',
    group: 'fire',
    tier: 0,
    emoji: 'üî•',
    piece: { target: 'random', water: false, notOnWood, onlyOnFlat, allowedInDungeons },
    comfort: { value: 1, group: 'fire', },
    fireplace: {
      fuel: 'Wood',
      capacity: 10,
      burnTime: 5000,
      minHeightAbove: 0.5,
      smoke: true,
      fireworks: true,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifiersFireplace,
      noRoof: false,
      noSupport: true,
      providesSupport,
      materialType: MaterialType.Wood,
    },
    recipe: {
      type: 'craft_piece',
      materials: { Wood: 5, Stone: 2 },
      station: CraftingStation.Workbench,
    }
  },
  { id: 'bonfire',
    base: true,
    type: 'piece',
    subtype: 'fireplace',
    group: 'fire',
    tier: 2,
    emoji: 'üî•',
    piece: { target: 'random', water: false, notOnWood, onlyOnFlat, },
    wear: {
      hp: 300,
      damageModifiers: damageModifiersFireplace,
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    comfort: { value: 1, group: 'fire' },
    fireplace: {
      fuel: 'Wood',
      capacity: 10,
      burnTime: 5000,
      minHeightAbove: 1,
      smoke: true,
      fireworks: true,
    },
    recipe: {
      type: 'craft_piece',
      materials: { 
        SurtlingCore: 1,
        ElderBark: 5,
        RoundLog: 5,
        FineWood: 5,
      },
      station: CraftingStation.Workbench,
    }
  },
  { id: 'hearth',
    base: true,
    type: 'piece',
    subtype: 'fireplace',
    group: 'fire',
    tier: 3,
    emoji: 'üî•',
    piece: { target: 'primary', water: false, },
    comfort: { value: 2, group: 'fire' },
    fireplace: {
      fuel: 'Wood',
      capacity: 20,
      burnTime: 5000,
      minHeightAbove: 0.7,
      smoke: true,
      fireworks: false,
    },
    wear: {
      hp: 1500,
      damageModifiers: craftStationResist,
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Stone,
    },
    recipe: stoneStructureRecipe(15),
  },
  { id: 'wood_stack',
    base: false,
    type: 'piece',
    subtype: 'misc',
    group: 'stack',
    tier: 0,
    emoji: 'ü™µ',
    wear: {
      hp: 50,
      damageModifiers: damageModifiersWood,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    piece: {
      target: 'random',
      water: undefined,
      allowedInDungeons,
    },
    recipe: { type: 'craft_piece', materials: { Wood: 50, }, station: CraftingStation.Workbench, }
  },
  { id: 'wood_fine_stack',
    base: false,
    type: 'piece',
    subtype: 'misc',
    group: 'stack',
    tier: 2,
    emoji: 'ü™µ',
    wear: {
      hp: 10,
      damageModifiers: damageModifiersWood,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    piece: {
      target: 'random',
      water: undefined,
      allowedInDungeons,
    },
    recipe: { type: 'craft_piece', materials: { FineWood: 50, }, station: CraftingStation.Inventory, }
  },
  { id: 'wood_core_stack',
    base: false,
    type: 'piece',
    subtype: 'misc',
    group: 'stack',
    tier: 1,
    emoji: 'ü™µ',
    wear: {
      hp: 10,
      damageModifiers: damageModifiersWood,
      noRoof: true,
      noSupport: true,
    },
    piece: {
      target: 'random',
      water: undefined,
      allowedInDungeons,
    },
    recipe: { type: 'craft_piece', materials: { RoundLog: 50, }, station: CraftingStation.Inventory, }
  },
  { id: 'stone_pile',
    base: false,
    type: 'piece',
    subtype: 'misc',
    group: 'stack',
    tier: 0,
    emoji: 'ü™®',
    piece: {
      target: 'random',
      water: undefined,
      allowedInDungeons,
    },
    wear: {
      hp: 50,
      damageModifiers: mods([0, 0, 0, 0, 2, 1, 1, 0, 3, 3]),
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Coal: 50, }, station: CraftingStation.Inventory, }
  },
  { id: 'coal_pile',
    base: false,
    type: 'piece',
    subtype: 'misc',
    group: 'stack',
    tier: 1,
    emoji: '',
    piece: {
      target: 'random',
      water: undefined,
      allowedInDungeons,
    },
    wear: {
      hp: 50,
      damageModifiers: mods([0, 0, 0, 0, 2, 2, 1, 0, 3, 3]),
      noRoof: false,
      noSupport: true,
    },
    recipe: { type: 'craft_piece', materials: { Stone: 50, }, station: CraftingStation.Inventory, }
  },
  /*{ id: 'tar_pile',
    disabled: true,
    base: false,
    type: 'piece',
    subtype: 'misc',
    group: 'stack',
    tier: 5,
    emoji: '',
    piece: {
      target: 'random',
      water: undefined,
      allowedInDungeons,
    },
    wear: {
      hp: 50,
      damageModifiers: mods([0, 0, 0, 0, 2, 2, 1, 0, 3, 3]),
      noRoof: false,
      noSupport: true,
    },
    recipe: { type: 'craft_piece', materials: { Stone: 50, }, station: CraftingStation.Inventory, }
  },*/
  { id: 'treasure_stack',
    base: false,
    type: 'piece',
    subtype: 'misc',
    group: 'stack',
    tier: 2,
    emoji: '',
    piece: {
      target: 'random',
      water: false,
      onlyOnFlat,
      allowedInDungeons,
    },
    wear: {
      hp: 5,
      damageModifiers: mods([2, 2, 2, 2, 2, 1, 3, 3, 3, 3]),
      noRoof: false,
      noSupport: true,
    },
    recipe: { type: 'craft_piece', materials: { Coins: 99, }, station: CraftingStation.Inventory, }
  },
  { id: 'treasure_pile',
    base: false,
    type: 'piece',
    subtype: 'misc',
    group: 'stack',
    tier: 2,
    emoji: '',
    piece: {
      target: 'random',
      water: undefined,
      onlyOnFlat,
      allowedInDungeons,
    },
    wear: {
      hp: 100,
      damageModifiers: mods([0, 0, 0, 0, 0, 1, 3, 3, 3, 3]),
      noRoof: false,
      noSupport: true,
    },
    recipe: { type: 'craft_piece', materials: { Coins: 999, }, station: CraftingStation.Inventory, }
  },
  { id: 'incinerator',
    base: false,
    type: 'piece',
    subtype: 'misc',
    tier: 2,
    emoji: '',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
    },
    wear: {
      hp: 1000,
      damageModifiers: mods([1, 1, 1, 1, 1, 1, 1, 3, 3, 3]),
      noRoof: false,
      noSupport: true,
    },
    recipe: { type: 'craft_piece', materials: { Iron: 8, Copper: 4, Thunderstone: 1 }, station: CraftingStation.Forge, }
  },
  { id: 'piece_cookingstation',
    base: false,
    type: 'piece',
    subtype: 'craft',
    group: 'cook',
    tier: 1,
    emoji: 'üç≥',
    craft: {
      id: CraftingStation.CookingStation,
      requiresFire,
      batchSize: 2,
    },
    piece: {
      target: 'primary',
      water: false,
      allowedInDungeons,
    },
    wear: {
      hp: 20,
      damageModifiers: damageModifiersCooking,
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Wood: 2, }, station: CraftingStation.Workbench, }
  },
  { id: 'piece_cookingstation_iron',
    base: false,
    type: 'piece',
    subtype: 'craft',
    group: 'cook',
    tier: 3,
    emoji: 'üç≥',
    craft: {
      id: CraftingStation.CookingStationIron,
      requiresFire,
      batchSize: 5,
    },
    piece: {
      target: 'primary',
      water: false,
      allowedInDungeons,
    },
    wear: {
      hp: 20,
      damageModifiers: mods([0, 0, 1, 0, 1, 3, 0, 0, 3, 3]),
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Iron: 3, Chain: 3 }, station: CraftingStation.Forge, }
  },
  { id: 'piece_cauldron',
    base: false,
    type: 'piece',
    subtype: 'craft',
    group: 'cook',
    tier: 2,
    emoji: 'üç≥',
    piece: {
      target: 'primary',
      water: false,
    },
    craft: {
      id: CraftingStation.Cauldron,
      requiresFire,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifiersCooking,
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Tin: 10, }, station: CraftingStation.Forge, }
  },
  { id: 'cauldron_ext1_spice',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 3,
    emoji: 'üß∞',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Cauldron,
      distance: 5,
    },
    wear: {
      hp: 50,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
    },
    recipe: { type: 'craft_piece', materials: { Dandelion: 3, Carrot: 2, Mushroom: 5, Thistle: 3, Turnip: 3 }, station: CraftingStation.Workbench, }
  },
  { id: 'cauldron_ext3_butchertable',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 4,
    emoji: 'üß∞',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2.5,
    },
    extends: {
      id: CraftingStation.Cauldron,
      distance: 5,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifiersWood,
      noRoof: true,
      noSupport: true,
    },
    recipe: { type: 'craft_piece', materials: { ElderBark: 2, RoundLog: 4, FineWood: 4, Silver: 2 }, station: CraftingStation.Workbench, }
  },
  { id: 'cauldron_ext4_pots',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 5,
    emoji: 'üß∞',
    piece: {
      target: 'primary',
      water: false,
      notOnFloor,
      requiredSpace: 2.5,
    },
    extends: {
      id: CraftingStation.Cauldron,
      distance: 5,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifiersWood,
      noRoof: true,
      noSupport: true,
    },
    recipe: { type: 'craft_piece', materials: { Iron: 5, Copper: 5, BlackMetal: 5 }, station: CraftingStation.Workbench, }
  },
  { id: 'piece_oven',
    base: false,
    type: 'piece',
    subtype: 'craft',
    group: 'cook',
    tier: 5,
    emoji: 'üç≥',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
    },
    // fuel: Wood, max: 10, burnTime: 2000
    craft: {
      id: CraftingStation.Oven,
    },
    wear: {
      hp: 500,
      damageModifiers: damageModifieresExtensions,
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Stone,
    },
    recipe: { type: 'craft_piece', materials: { Iron: 15, Stone: 20, SurtlingCore: 4 }, station: CraftingStation.ArtisanTable, }
  },
  { id: 'piece_workbench',
    base: true,
    type: 'piece',
    subtype: 'craft',
    tier: 1,
    emoji: 'üß∞',
    piece: {
      target: 'primary',
      water: false,
    },
    craft: {
      id: CraftingStation.Workbench,
      requiresRoof,
    },
    wear: {
      hp: 100,
      damageModifiers: mods([0, 0, 1, 2, 0, 0, 0, 0, 3, 3]),
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Wood: 10, }, station: CraftingStation.Inventory, }
  },
  { id: 'piece_workbench_ext1',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 1,
    emoji: 'üß∞',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Workbench,
      distance: 5,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Wood: 10, Flint: 10 }, station: CraftingStation.Workbench, }
  },
  { id: 'piece_workbench_ext2',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 1,
    emoji: 'üß∞',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Workbench,
      distance: 5,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Wood: 10, Flint: 15, LeatherScraps: 20, DeerHide: 5, }, station: CraftingStation.Workbench, }
  },
  { id: 'piece_workbench_ext3',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 2,
    emoji: 'üß∞',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Workbench,
      distance: 5,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { FineWood: 10, Bronze: 3, }, station: CraftingStation.Forge, }
  },
  { id: 'piece_workbench_ext4',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 4,
    emoji: 'üß∞',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Workbench,
      distance: 5,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { FineWood: 10, Iron: 4, Obsidian: 4, }, station: CraftingStation.Forge, }
  },
  { id: 'piece_stonecutter',
    base: true,
    type: 'piece',
    subtype: 'craft',
    tier: 3,
    emoji: '‚öíÔ∏è',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    craft: {
      id: CraftingStation.StoneCutter,
      buildRange: 20,
      requiresRoof,
    },
    wear: {
      hp: 200,
      damageModifiers: mods([0, 0, 1, 2, 0, 0, 0, 0, 3, 3]),
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Wood: 10, Iron: 2, Stone: 4 }, station: CraftingStation.Forge, }
  },
  { id: 'piece_artisanstation',
    base: true,
    type: 'piece',
    subtype: 'craft',
    tier: 5,
    emoji: 'üî¨',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
    },
    craft: {
      id: CraftingStation.ArtisanTable,
      buildRange: 40,
      requiresRoof,
    },
    wear: {
      hp: 200,
      damageModifiers: mods([0, 0, 1, 2, 0, 0, 0, 0, 3, 3]),
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { FineWood: 10, DragonTear: 2, }, station: CraftingStation.Workbench, }
  },
  { id: 'forge',
    base: true,
    type: 'piece',
    subtype: 'craft',
    tier: 2,
    emoji: 'üõ†Ô∏è',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
    },
    craft: {
      id: CraftingStation.Forge,
      buildRange: 20,
      requiresRoof,
    },
    wear: {
      hp: 200,
      damageModifiers: mods([0, 0, 1, 2, 0, 0, 0, 0, 3, 3]),
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Stone: 4, Coal: 4, Wood: 10, Copper: 6 }, station: CraftingStation.Workbench, }
  },
  { id: 'forge_ext5',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 3,
    emoji: 'üõ†Ô∏è',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Forge,
      distance: 5,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { FineWood: 25, Copper: 10, }, station: CraftingStation.Workbench, }
  },
  { id: 'forge_ext2',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 2,
    emoji: 'üõ†Ô∏è',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Forge,
      distance: 5,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Wood: 5, Bronze: 2, }, station: CraftingStation.Workbench, }
  },
  { id: 'forge_ext4',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 3,
    emoji: 'üõ†Ô∏è',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Forge,
      distance: 5,
    },
    wear: {
      hp: 1000,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Iron: 20, Wood: 5, }, station: CraftingStation.Workbench, }
  },
  { id: 'forge_ext6',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 4,
    emoji: 'üõ†Ô∏è',
    piece: {
      target: 'primary',
      water: false,
      notOnFloor,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Forge,
      distance: 5,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Iron: 15, Wood: 10, }, station: CraftingStation.Workbench, }
  },
  { id: 'forge_ext1',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 2,
    emoji: 'üõ†Ô∏è',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Forge,
      distance: 2,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Wood: 5, DeerHide: 5, Chain: 4 }, station: CraftingStation.Workbench, }
  },
  { id: 'forge_ext3',
    base: false,
    type: 'piece',
    subtype: 'craft_ext',
    tier: 2,
    emoji: 'üõ†Ô∏è',
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
      requiredSpace: 2,
    },
    extends: {
      id: CraftingStation.Forge,
      distance: 5,
    },
    wear: {
      hp: 100,
      damageModifiers: damageModifieresExtensions,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Wood,
    },
    recipe: { type: 'craft_piece', materials: { Wood: 25, SharpeningStone: 1, }, station: CraftingStation.Workbench, }
  },
  { id: 'smelter',
    base: true,
    type: 'piece',
    subtype: 'craft',
    group: 'smelt',
    tier: 2,
    emoji: 'üî•',
    piece: {
      target: 'primary',
      water: false,
      notOnWood,
      onlyOnFlat,
    },
    craft: { id: CraftingStation.Smelter },
    wear: {
      hp: 2000,
      damageModifiers: craftStationResist,
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Stone,
    },
    recipe: { type: 'craft_piece', materials: { Stone: 20, SurtlingCore: 5, }, station: CraftingStation.Workbench, }
  },
  { id: 'blastfurnace',
    base: true,
    type: 'piece',
    subtype: 'craft',
    group: 'smelt',
    tier: 5,
    emoji: 'üî•',
    piece: {
      target: 'primary',
      water: false,
      notOnWood,
      onlyOnFlat,
    },
    craft: {
      id: CraftingStation.BlastFurnace,
      queueSize: 10,
    },
    wear: {
      hp: 2000,
      damageModifiers: craftStationResist,
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Stone,
    },
    recipe: { type: 'craft_piece', materials: { Stone: 20, SurtlingCore: 5, Iron: 10, FineWood: 20 }, station: CraftingStation.ArtisanTable, }
  },
  { id: 'charcoal_kiln',
    base: true,
    type: 'piece',
    subtype: 'craft',
    group: 'smelt',
    tier: 2,
    emoji: 'üî•',
    piece: {
      target: 'primary',
      water: false,
      notOnWood,
      onlyOnFlat,
    },
    craft: { id: CraftingStation.CharcoalKiln, queueSize: 25 },
    wear: {
      hp: 1500,
      damageModifiers: craftStationResist,
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Stone,
    },
    recipe: { type: 'craft_piece', materials: { Stone: 20, SurtlingCore: 5, }, station: CraftingStation.Workbench, }
  },
  { id: 'windmill',
    base: true,
    type: 'piece',
    subtype: 'craft',
    tier: 5,
    emoji: 'üî•',
    piece: {
      target: 'primary',
      water: false,
      notOnWood,
      onlyOnFlat,
    },
    craft: { id: CraftingStation.Windmill, queueSize: 50 },
    wear: {
      hp: 1000,
      damageModifiers: craftStationResist,
      noRoof: false,
      noSupport: true,
      materialType: MaterialType.Stone,
    },
    recipe: { type: 'craft_piece', materials: { Stone: 20, Wood: 30, IronNails: 30 }, station: CraftingStation.ArtisanTable, }
  },
  { id: 'piece_spinningwheel',
    base: true,
    type: 'piece',
    subtype: 'craft',
    tier: 5,
    piece: {
      target: 'primary',
      water: false,
      onlyOnFlat,
    },
    craft: { id: CraftingStation.SpinningWheel, queueSize: 40, requiresRoof, },
    wear: {
      hp: 200,
      damageModifiers: craftStationResist,
      noRoof: true,
      noSupport: true,
      materialType: MaterialType.Stone,
    },
    recipe: { type: 'craft_piece', materials: { FineWood: 20, IronNails: 10, LeatherScraps: 5 }, station: CraftingStation.ArtisanTable, }
  },
  // walls / floors
  { id: 'wood_floor',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'none', water: undefined, size: [2, 2, 0] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_floor_1x1',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'none', water: undefined, size: [1, 1, 0] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(1),
  },
  { id: 'wood_wall',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 2] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_wall_half',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 1] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(1),
  },
  { id: 'wood_wall_quarter',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [1, 0, 1] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(1),
  },
  { id: 'wood_window',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    emoji: 'üö™',
    piece: { target: 'random', water: undefined, size: [1, 0, 1] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(4),
  },
  { id: 'wood_door',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    emoji: 'üö™',
    piece: { target: 'random', water: undefined, size: [2, 0, 2] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(4),
  },
  { id: 'wood_gate',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    emoji: 'üö™',
    piece: { target: 'random', water: undefined, size: [2, 0, 3] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(12),
  },
  { id: 'darkwood_gate',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    emoji: 'üö™',
    piece: { target: 'random', water: undefined, size: [2, 0, 3] },
    wear: woodStructureWear,
    recipe: { type: 'craft_piece', materials: { Wood: 16, Iron: 4, Tar: 2 }, station: CraftingStation.Forge, },
  },
  { id: 'wood_stair',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    emoji: 'ü™ú',
    piece: { target: 'none', water: undefined, size: [2, 3, 1] },
    wear: {
      hp: 1000,
      damageModifiers: woodResist,
      materialType: MaterialType.HardWood, 
    },
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_stepladder',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    emoji: 'ü™ú',
    piece: { target: 'none', water: undefined, size: [2, 3, 1] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_roof_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 2, 1] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_roof_top_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 2, 1] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_roof_ocorner_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 2, 1] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_roof_icorner_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 2, 1] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_wall_roof_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 2] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_wall_roof_45_updsidedown',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 2] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_wall_roof_top_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 1] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_roof',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 2] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_roof_top',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 2, 1] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_roof_ocorner',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 2, 1] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_roof_icorner',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 2, 1] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_wall_roof',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 1] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_wall_roof_upsidedown',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 1] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_wall_roof_top',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 1] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_pole',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [0, 0, 1] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(1),
  },
  { id: 'wood_pole2',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [0, 0, 2] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_beam1',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [1, 0, 0] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(1),
  },
  { id: 'wood_beam',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 0] },
    wear: { ...woodStructureWear, damageModifiers: stoneResist },
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_beam_26',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 1] },
    wear: { ...woodStructureWear, damageModifiers: stoneResist },
    recipe: woodStructureRecipe(2),
  },
  { id: 'wood_beam_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 1] },
    wear: { ...woodStructureWear, damageModifiers: stoneResist },
    recipe: woodStructureRecipe(2),
  },
  { id: 'woodiron_pole',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [2, 0, 1] },
    wear: wearStructure(2000, woodResist, MaterialType.Iron),
    recipe: { type: 'craft_piece', materials: { Wood: 2, Iron: 1 }, station: CraftingStation.Forge, },
  },
  { id: 'woodiron_beam',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [2, 0, 1] },
    wear: wearStructure(2000, woodResist, MaterialType.Iron),
    recipe: { type: 'craft_piece', materials: { Wood: 2, Iron: 1 }, station: CraftingStation.Forge, },
  },
  { id: 'crystal_wall_1x1',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    tier: 3,
    comfort: { value: 1 },
    piece: { target: 'random', water: undefined, size: [2, 0, 1] },
    wear: {
      hp: 10,
      damageModifiers: mods([0, 0, 0, 2, 0, 0, 0, 0, 3, 3]),
      noRoof: false,
    },
    recipe: { type: 'craft_piece', materials: { Crystal: 2 }, station: CraftingStation.Workbench },
  },
  { id: 'wood_dragon',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 2,
    piece: { target: 'random', water: undefined, size: [3, 0, 2] },
    wear: woodRoofStructureWear,
    recipe: woodStructureRecipe(10, 'FineWood'),
  },
  { id: 'wood_wall_log_4x0.5',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 2,
    piece: { target: 'random', water: undefined, size: [4, 0.5, 0.5] },
    wear: wearStructure(500, woodResist, MaterialType.HardWood),
    recipe: woodStructureRecipe(2, 'RoundLog'),
  },
  { id: 'wood_wall_log',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 2,
    piece: { target: 'random', water: undefined, size: [2, 0.5, 0.5] },
    wear: wearStructure(500, woodResist, MaterialType.HardWood),
    recipe: woodStructureRecipe(1, 'RoundLog'),
  },
  { id: 'wood_pole_log',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 2,
    piece: { target: 'random', water: undefined, size: [0.5, 0.5, 2] },
    wear: wearStructure(500, woodResist, MaterialType.HardWood),
    recipe: woodStructureRecipe(1, 'RoundLog'),
  },
  { id: 'wood_pole_log_4',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 2,
    piece: { target: 'random', water: undefined, size: [0.5, 0.5, 2] },
    wear: wearStructure(500, woodResist, MaterialType.HardWood),
    recipe: woodStructureRecipe(2, 'RoundLog'),
  },
  { id: 'darkwood_roof',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 1, 2] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_roof_top',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 0.5, 2] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_roof_ocorner',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 1, 2] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_roof_icorner',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 1, 2] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_roof_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 2, 2] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_roof_top_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 1, 2] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_roof_ocorner_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 2, 2] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_roof_icorner_45',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 2, 2] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_pole',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [0, 2, 0] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_pole4',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [0, 4, 0] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 4, Tar: 1 }),
  },
  { id: 'darkwood_beam',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 0, 0] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_beam4',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [4, 0, 0] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 4, Tar: 1 }),
  },
  { id: 'darkwood_decowall',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 0, 2] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ FineWood: 2, Tar: 1 }),
  },
  { id: 'darkwood_arch',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 0, 2] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ Wood: 2, Tar: 1 }),
  },
  { id: 'darkwood_raven',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 1, 1] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ FineWood: 10, Tar: 1 }),
  },
  { id: 'darkwood_wolf',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 5,
    piece: { target: 'random', water: undefined, size: [2, 1, 1] },
    wear: darkwoodStructureWear,
    recipe: darkwoodStructureRecipe({ FineWood: 10, Tar: 1 }),
  },
  { id: 'wood_fence',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 2] },
    wear: woodStructureWear,
    recipe: woodStructureRecipe(2),
  },
  { id: 'stake_wall',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 1,
    piece: { target: 'random', water: undefined, size: [2, 0, 3] },
    wear: wearStructure(1000, woodResist, MaterialType.Wood, { noRoof: false }),
    recipe: woodStructureRecipe(2),
  },
  { id: 'piece_sharpstakes',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 2,
    piece: { target: 'random', water: undefined, groundOnly, size: [3, 0, 1] },
    wear: wearStructure(200, woodResist, MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Wood: 6, RoundLog: 4 }, station: CraftingStation.Workbench, },
  },
  { id: 'stone_wall_1x1',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [1, 1, 1] },
    wear: stoneStructureWear,
    recipe: stoneStructureRecipe(3),
  },
  { id: 'stone_wall_2x1',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [2, 1, 1] },
    wear: stoneStructureWear,
    recipe: stoneStructureRecipe(4),
  },
  { id: 'stone_wall_4x2',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [4, 1, 2] },
    wear: stoneStructureWear,
    recipe: stoneStructureRecipe(6),
  },
  { id: 'stone_pillar',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [1, 1, 2] },
    wear: stoneStructureWear,
    recipe: stoneStructureRecipe(5),
  },
  { id: 'stone_arch',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [2, 1, 1] },
    wear: stoneStructureWear,
    recipe: stoneStructureRecipe(4),
  },
  { id: 'stone_floor_2x2',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [2, 2, 1] },
    wear: stoneStructureWear,
    recipe: stoneStructureRecipe(6),
  },
  { id: 'stone_floor',
    disabled: true,
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [4, 4, 1] },
    wear: stoneStructureWear,
    recipe: stoneStructureRecipe(8),
  },
  { id: 'iron_gate',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [2, 0, 3] },
    wear: wearStructure(2000, mods([0, 0, 0, 0, 0, 0, 0, 0, 3, 3]), MaterialType.Iron),
    recipe: { type: 'craft_piece', materials: { Iron: 4 }, station: CraftingStation.Forge },
  },
  { id: 'stone_stair',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [2, 2, 1] },
    wear: stoneStructureWear,
    recipe: stoneStructureRecipe(8),
  },
  { id: 'iron_floor_1x1',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [1, 0, 1] },
    wear: {
      hp: 500,
      damageModifiers: ironResist,
      materialType: MaterialType.Iron,
    },
    recipe: ironStructureRecipe(1),
  },
  { id: 'iron_floor_2x2',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [2, 0, 2] },
    wear: {
      hp: 1000,
      damageModifiers: ironResist,
      materialType: MaterialType.Iron,
    },
    recipe: ironStructureRecipe(2),
  },
  { id: 'iron_wall_1x1',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [1, 0, 1] },
    wear: {
      hp: 500,
      damageModifiers: ironResist,
      materialType: MaterialType.Iron,
    },
    recipe: ironStructureRecipe(1),
  },
  { id: 'iron_wall_2x2',
    base: false,
    type: 'piece',
    subtype: 'structure',
    tier: 3,
    piece: { target: 'random', water: undefined, size: [2, 0, 2] },
    wear: {
      hp: 1000,
      damageModifiers: ironResist,
      materialType: MaterialType.Iron,
    },
    recipe: ironStructureRecipe(2),
  },
  { id: 'bed',
    group: 'bed', 
    base: true,
    type: 'piece',
    subtype: 'bed',
    tier: 1,
    emoji: 'üõèÔ∏è',
    piece: { target: 'primary', water: false, onlyOnFlat, size: [2, 1, 0.5] },
    comfort: { value: 1, group: 'bed' },
    wear: wearStructure(100, woodResist, MaterialType.Wood),
    recipe: woodStructureRecipe(8),
  },
  { id: 'piece_bed02',
    group: 'bed', 
    base: true,
    type: 'piece',
    subtype: 'bed',
    tier: 4,
    emoji: 'üõèÔ∏è',
    piece: { target: 'primary', water: false, onlyOnFlat, size: [2, 2, 2] },
    comfort: { value: 2, group: 'bed' },
    wear: wearStructure(300, woodResist, MaterialType.Wood),
    recipe: {
      type: 'craft_piece',
      materials: { FineWood: 40, DeerHide: 7, WolfPelt: 4, Feathers: 10, IronNails: 15 },
      station: CraftingStation.Workbench,
    },
  },
  { id: 'piece_chest_wood',
    group: 'chest', 
    base: false,
    type: 'piece',
    subtype: 'chest',
    tier: 1,
    space: [5, 2],
    piece: { target: 'primary', water: false, onlyOnFlat, size: [2, 1, 1] },
    wear: wearStructure(100, chestResist, MaterialType.Wood, { noRoof: false }),
    recipe: woodStructureRecipe(10),
  },
  { id: 'piece_chest',
    group: 'chest', 
    base: false,
    type: 'piece',
    subtype: 'chest',
    tier: 3,
    space: [6, 4],
    piece: { target: 'primary', water: false, onlyOnFlat, size: [2, 1, 1] },
    wear: wearStructure(1000, chestResist, MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { FineWood: 10, Iron: 2 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_chest_private',
    group: 'chest', 
    base: false,
    type: 'piece',
    subtype: 'chest',
    tier: 3,
    space: [3, 2],
    piece: { target: 'primary', water: false, onlyOnFlat, size: [1, 0.5, 0.5] },
    wear: wearStructure(10000, chestResist, MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { FineWood: 10, Iron: 8 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_chest_blackmetal',
    group: 'chest', 
    base: false,
    type: 'piece',
    subtype: 'chest',
    tier: 3,
    space: [8, 4],
    piece: { target: 'primary', water: false, onlyOnFlat, size: [1, 0.5, 0.5] },
    wear: wearStructure(1000, chestResist, MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Wood: 10, Tar: 2, BlackMetal: 6 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_chest_treasure',
    base: false,
    type: 'piece',
    subtype: 'misc',
    tier: 3,
    piece: { target: 'primary', water: false, onlyOnFlat, size: [1, 0.5, 0.5] },
    wear: wearStructure(200, mods([0, 0, 1, 0, 0, 2, 1, 0, 3, 3]), undefined, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Coins: 99, Ruby: 5, SilverNecklace: 2, FineWood: 8, Silver: 2 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_chair',
    base: false,
    type: 'piece',
    group: 'chair',
    subtype: 'chair',
    emoji: 'ü™ë',
    tier: 2,
    comfort: { value: 1, group: 'chair' },
    piece: { target: 'random', water: false, onlyOnFlat, size: [0.5, 0.5, 0.5] },
    wear: wearStructure(100, woodResist, MaterialType.Wood),
    recipe: woodStructureRecipe(4, 'FineWood'),
  },
  { id: 'piece_chair02',
    base: false,
    type: 'piece',
    group: 'chair',
    subtype: 'chair',
    tier: 2,
    emoji: 'ü™ë',
    comfort: { value: 2, group: 'chair' },
    piece: { target: 'random', water: false, onlyOnFlat, size: [0.5, 0.5, 1] },
    wear: wearStructure(100, woodResist, MaterialType.Wood),
    recipe: woodStructureRecipe(4, 'FineWood'),
  },
  { id: 'piece_chair03',
    base: false,
    type: 'piece',
    group: 'chair',
    subtype: 'chair',
    tier: 5,
    emoji: 'ü™ë',
    comfort: { value: 2, group: 'chair' },
    piece: { target: 'random', water: false, onlyOnFlat, size: [0.5, 0.5, 1] },
    wear: wearStructure(200, woodResist, MaterialType.Wood),
    recipe: { type: 'craft_piece', materials: { FineWood: 4, Tar: 1, IronNails: 5, DeerHide: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_bench01',
    base: false,
    type: 'piece',
    group: 'chair',
    subtype: 'chair',
    tier: 2,
    emoji: 'üõãÔ∏è',
    comfort: { value: 1, group: 'chair' },
    piece: { target: 'random', water: false, onlyOnFlat, size: [2, 0.5, 0.5] },
    wear: wearStructure(100, woodResist, MaterialType.Wood),
    recipe: woodStructureRecipe(4, 'FineWood'),
  },
  { id: 'piece_logbench01',
    base: false,
    type: 'piece',
    group: 'chair',
    subtype: 'chair',
    tier: 3,
    emoji: 'ü™ë',
    comfort: { value: 1, group: 'chair' },
    piece: { target: 'random', water: false, onlyOnFlat, allowedInDungeons, size: [1, 1, 1.5] },
    wear: wearStructure(100, woodResist, MaterialType.Wood),
    recipe: woodStructureRecipe(2, 'RoundLog'),
  },
  { id: 'piece_throne01',
    base: false,
    type: 'piece',
    group: 'chair',
    subtype: 'chair',
    tier: 3,
    emoji: 'ü™ë',
    comfort: { value: 3, group: 'chair' },
    piece: { target: 'random', water: false, onlyOnFlat, size: [1, 1, 1.5] },
    wear: wearStructure(250, woodResist, MaterialType.Wood),
    recipe: { type: 'craft_piece', materials: { FineWood: 20, IronNails: 10 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_throne02',
    base: false,
    type: 'piece',
    group: 'chair',
    subtype: 'chair',
    tier: 3,
    emoji: 'ü™ë',
    comfort: { value: 3, group: 'chair' },
    piece: { target: 'random', water: false, onlyOnFlat, size: [1, 1, 1.5] },
    wear: wearStructure(500, stoneResist, MaterialType.Stone),
    recipe: { type: 'craft_piece', materials: { Stone: 20, DeerHide: 2, WolfPelt: 2 }, station: CraftingStation.StoneCutter },
  },
  { id: 'piece_table',
    base: false,
    type: 'piece',
    subtype: 'table',
    tier: 2,
    comfort: { value: 1, group: 'table' },
    piece: { target: 'random', water: false, onlyOnFlat, size: [3, 2, 0.5] },
    wear: wearStructure(100, woodResist, MaterialType.Wood),
    recipe: woodStructureRecipe(6, 'FineWood'),
  },
  { id: 'piece_table_round',
    base: false,
    type: 'piece',
    subtype: 'table',
    tier: 2,
    comfort: { value: 2, group: 'table' },
    piece: { target: 'random', water: false, onlyOnFlat, size: [4, 4, 0.5] },
    wear: wearStructure(150, woodResist, MaterialType.Wood),
    recipe: { type: 'craft_piece', materials: { FineWood: 10, Tar: 2, IronNails: 20 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_table_oak',
    base: false,
    type: 'piece',
    subtype: 'table',
    tier: 2,
    comfort: { value: 2, group: 'table' },
    piece: { target: 'random', water: false, onlyOnFlat, size: [4, 2, 0.5] },
    wear: wearStructure(200, woodResist, MaterialType.Wood),
    recipe: { type: 'craft_piece', materials: { FineWood: 20, Tar: 2, IronNails: 20 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_bathtub',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    emoji: 'üõÅ',
    tier: 5,
    comfort: { value: 2 },
    piece: { target: 'random', water: false, onlyOnFlat, size: [3, 3, 1] },
    wear: wearStructure(400, woodResist, MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Wood: 20, Tar: 6, Iron: 10, Stone: 8 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_walltorch',
    base: true,
    type: 'piece',
    subtype: 'fireplace',
    group: 'torch',
    tier: 3,
    fireplace: { fuel: 'Resin', capacity: 6, burnTime: 20000, minHeightAbove: 0.68, smoke: false, fireworks: false },
    piece: { target: 'primary', water: undefined, onlyOnFlat, size: [0, 0, 1.5] },
    wear: wearStructure(100, mods([2, 0, 0, 0, 0, 0, 0, 0, 3, 3]), undefined, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Wood: 2, Copper: 2, Resin: 2 }, station: CraftingStation.Forge },
  },
  { id: 'piece_groundtorch',
    base: true,
    type: 'piece',
    subtype: 'fireplace',
    group: 'torch',
    tier: 3,
    fireplace: { fuel: 'Resin', capacity: 6, burnTime: 20000, minHeightAbove: 0.76, smoke: false, fireworks: false },
    piece: { target: 'primary', water: undefined, onlyOnFlat, size: [0, 0, 1.5] },
    wear: wearStructure(200, mods([0, 0, 1, 0, 0, 3, 3, 0, 3, 3]), undefined, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Iron: 2, Resin: 2 }, station: CraftingStation.Forge },
  },
  { id: 'piece_groundtorch_wood',
    base: true,
    type: 'piece',
    subtype: 'fireplace',
    group: 'torch',
    tier: 1,
    fireplace: { fuel: 'Resin', capacity: 4, burnTime: 10000, minHeightAbove: 0.76, smoke: false, fireworks: false },
    piece: { target: 'primary', water: undefined, onlyOnFlat, size: [0, 0, 1.5] },
    wear: wearStructure(100, mods([0, 2, 1, 2, 0, 0, 0, 0, 3, 3]), undefined, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Iron: 2, Resin: 2 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_groundtorch_green',
    base: true,
    type: 'piece',
    subtype: 'fireplace',
    group: 'torch',
    tier: 3,
    fireplace: { fuel: 'Guck', capacity: 6, burnTime: 20000, minHeightAbove: 0.76, smoke: false, fireworks: false },
    piece: { target: 'primary', water: undefined, onlyOnFlat, size: [0, 0, 1.5] },
    wear: wearStructure(200, mods([0, 0, 1, 0, 0, 3, 3, 0, 3, 3]), undefined, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Iron: 2, Resin: 2 }, station: CraftingStation.Forge },
  },
  { id: 'piece_groundtorch_blue',
    base: true,
    type: 'piece',
    subtype: 'fireplace',
    group: 'torch',
    tier: 3,
    fireplace: { fuel: 'GreydwarfEye', capacity: 6, burnTime: 20000, minHeightAbove: 0.76, smoke: false, fireworks: false },
    piece: { target: 'primary', water: undefined, onlyOnFlat, size: [0, 0, 1.5] },
    wear: wearStructure(200, mods([0, 0, 1, 0, 0, 3, 3, 0, 3, 3]), undefined, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Iron: 2, GreydwarfEye: 2 }, station: CraftingStation.Forge },
  },
  { id: 'piece_brazierceiling01',
    base: true,
    type: 'piece',
    subtype: 'fireplace',
    group: 'torch',
    tier: 3,
    fireplace: { fuel: 'Coal', capacity: 5, burnTime: 20000, minHeightAbove: 0.28, smoke: false, fireworks: false },
    comfort: { value: 1, group: 'fire' },
    piece: { target: 'random', water: false, onlyOnFlat, size: [0, 0, 1.5] },
    wear: wearStructure(100, mods([0, 0, 0, 0, 0, 3, 3, 0, 3, 3]), MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Bronze: 5, Coal: 2, Chain: 1 }, station: CraftingStation.Forge },
  },
  { id: 'portal_wood',
    base: true,
    type: 'piece',
    subtype: 'misc',
    tier: 2,
    piece: { target: 'primary', water: false, onlyOnFlat, size: [3, 3, 0] },
    wear: wearStructure(400, mods([1, 0, 1, 2, 1, 0, 0, 0, 3, 3]), MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { GreydwarfEye: 10, FineWood: 20, SurtlingCore: 2 }, station: CraftingStation.Workbench },
  },
  { id: 'guard_stone',
    base: true,
    type: 'piece',
    subtype: 'misc',
    tier: 2,
    piece: { target: 'primary', water: false, onlyOnFlat, size: [0.5, 0.5, 1] },
    wear: wearStructure(1000, mods([0, 0, 1, 4, 4, 0, 1, 0, 3, 3]), undefined, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { FineWood: 5, GreydwarfEye: 5, SurtlingCore: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_cartographytable',
    base: false,
    type: 'piece',
    subtype: 'misc',
    tier: 2,
    piece: { target: 'none', water: false, onlyOnFlat, size: [4, 1, 2] },
    wear: wearStructure(100, woodResist, undefined),
    recipe: { type: 'craft_piece', materials: { FineWood: 10, BoneFragments: 10, Bronze: 2, LeatherScraps: 5, Raspberry: 4 }, station: CraftingStation.Workbench },
  },
  { id: 'itemstand',
    base: false,
    type: 'piece',
    subtype: 'stand',
    group: 'stand',
    supportedTypes: [
      ItemType.OneHandedWeapon,
      ItemType.TwoHandedWeapon,
      ItemType.Bow,
      ItemType.Tool,
      ItemType.Shield,
      ItemType.Helmet,
      ItemType.Trophie,
      ItemType.Misc,
      ItemType.Consumable,
    ], // ['weapon', 'tool', 'shield', 'armor/head', 'trophy', 'resource', 'food', 'potion']
    tier: 2,
    piece: { target: 'none', water: false, onlyOnFlat, size: [0.25, 0.25, 0] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { FineWood: 4, BronzeNails: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'itemstandh',
    base: false,
    type: 'piece',
    subtype: 'stand',
    group: 'stand',
    supportedTypes: [
      ItemType.OneHandedWeapon,
      ItemType.TwoHandedWeapon,
      ItemType.Bow,
      ItemType.Tool,
      ItemType.Shield,
      ItemType.Helmet,
      ItemType.Trophie,
      ItemType.Misc,
    ], // -MeadTasty
    // ['weapon', 'tool', 'shield', 'armor/head', 'trophy', 'resource']
    tier: 2,
    piece: { target: 'none', water: undefined, size: [0.25, 0, 0.25] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { FineWood: 4, BronzeNails: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'sign',
    base: false,
    type: 'piece',
    subtype: 'misc',
    tier: 2,
    piece: { target: 'none', water: undefined, size: [0.25, 0.1, 0] },
    wear: { ...woodRoofStructureWear, hp: 100 },
    recipe: { type: 'craft_piece', materials: { Wood: 2, Coal: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'rug_deer',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    group: 'rug',
    tier: 1,
    comfort: { value: 1 },
    piece: { target: 'none', water: undefined, onlyOnFlat, size: [2, 1.5, 0] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { DeerHide: 4 }, station: CraftingStation.Workbench },
  },
  { id: 'rug_wolf',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    group: 'rug',
    tier: 4,
    comfort: { value: 1 },
    piece: { target: 'none', water: undefined, onlyOnFlat, size: [2, 1.5, 0] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { WolfPelt: 4 }, station: CraftingStation.Workbench },
  },
  { id: 'rug_fur', // lox
    base: false,
    type: 'piece',
    subtype: 'decoration',
    group: 'rug',
    tier: 5,
    comfort: { value: 1 },
    piece: { target: 'none', water: undefined, onlyOnFlat, size: [0.25, 0, 1] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { LoxPelt: 4 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_banner01',
    group: 'banner',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    tier: 2,
    comfort: { value: 1, group: 'banner' },
    piece: { target: 'none', water: undefined, size: [1, 2, 0] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { LeatherScraps: 6, FineWood: 2, Coal: 4 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_banner02',
    group: 'banner',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    tier: 2,
    comfort: { value: 1, group: 'banner' },
    piece: { target: 'none', water: undefined, size: [1, 2, 0] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { LeatherScraps: 6, FineWood: 2, Blueberries: 4 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_banner03',
    group: 'banner',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    tier: 2,
    comfort: { value: 1, group: 'banner' },
    piece: { target: 'none', water: undefined, size: [1, 2, 0] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { LeatherScraps: 6, FineWood: 2, Raspberry: 4 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_banner04',
    group: 'banner',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    tier: 3,
    comfort: { value: 1, group: 'banner' },
    piece: { target: 'none', water: undefined, size: [1, 2, 0] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { LeatherScraps: 6, FineWood: 2, Bloodbag: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_banner05',
    group: 'banner',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    tier: 3,
    comfort: { value: 1, group: 'banner' },
    piece: { target: 'none', water: undefined, size: [1, 2, 0] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { LeatherScraps: 6, FineWood: 2, Guck: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_banner06',
    group: 'banner',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    tier: 3,
    comfort: { value: 1, group: 'banner' },
    piece: { target: 'none', water: undefined, size: [1, 2, 0] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { LeatherScraps: 6, FineWood: 2, Blueberries: 2, Raspberry: 2, Cloudberry: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_banner07',
    group: 'banner',
    base: false,
    type: 'piece',
    subtype: 'decoration',
    tier: 3,
    comfort: { value: 1, group: 'banner' },
    piece: { target: 'none', water: undefined, size: [1, 2, 0] },
    wear: { ...woodRoofStructureWear, hp: 50 },
    recipe: { type: 'craft_piece', materials: { LeatherScraps: 6, FineWood: 2, Blueberries: 2, Cloudberry: 3 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_beehive',
    base: false,
    type: 'piece',
    subtype: 'craft',
    tier: 1,
    emoji: 'üêùüè†',
    craft: { id: CraftingStation.BeeHive },
    piece: { target: 'primary', water: undefined, size: [0.5, 0.5, 0.5] },
    wear: { ...woodRoofStructureWear, hp: 100 },
    recipe: { type: 'craft_piece', materials: { Wood: 10, QueenBee: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'fermenter',
    base: true,
    type: 'piece',
    subtype: 'craft',
    tier: 2,
    craft: { id: CraftingStation.Fermenter, requiresRoof },
    piece: { target: 'primary', water: false, onlyOnFlat, size: [2, 2, 3] },
    wear: wearStructure(1000, craftStationResist, MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { FineWood: 30, Bronze: 5, Resin: 10 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_gift1', season: 'christmas',
    base: false,
    type: 'piece',
    subtype: 'chest',
    tier: 1,
    emoji: 'üéÅ',
    space: [1, 1],
    piece: { target: 'none', water: false, onlyOnFlat, size: [0.5, 0.5, 0.5] },
    wear: wearStructure(10, mods([1, 1, 1, 1, 1, 1, 1, 0, 3, 3]), MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { FineWood: 2, BoneFragments: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_gift2', season: 'christmas',
    base: false,
    type: 'piece',
    subtype: 'chest',
    tier: 1,
    emoji: 'üéÅ',
    space: [1, 1],
    piece: { target: 'none', water: false, onlyOnFlat, size: [0.5, 0.5, 0.5] },
    wear: wearStructure(10, mods([1, 1, 1, 1, 1, 1, 1, 0, 3, 3]), MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { FineWood: 3, Dandelion: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_gift3', season: 'christmas',
    base: false,
    type: 'piece',
    subtype: 'chest',
    tier: 1,
    emoji: 'üéÅ',
    space: [1, 1],
    piece: { target: 'none', water: false, onlyOnFlat, size: [0.5, 0.5, 0.5] },
    wear: wearStructure(10, mods([1, 1, 1, 1, 1, 1, 1, 0, 3, 3]), MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { FineWood: 4, Raspberry: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_xmastree', season: 'christmas',
    base: false,
    type: 'piece',
    tier: 2,
    emoji: 'üéÑ',
    subtype: 'decoration',
    comfort: { value: 1 },
    piece: { target: 'random', water: undefined, size: [1, 1, 3] },
    wear: wearStructure(50, woodResist, MaterialType.Wood, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Wood: 10, FirCone: 1 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_maypole', season: 'midsummer',
    base: false,
    type: 'piece',
    tier: 2,
    subtype: 'decoration',
    comfort: { value: 1 },
    piece: { target: 'random', water: undefined, size: [4, 0.5, 4.2] },
    wear: wearStructure(50, woodResist, undefined, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Wood: 10, Dandelion: 4, Thistle: 4 }, station: CraftingStation.Workbench },
  },
  { id: 'piece_jackoturnip', season: 'helloween',
    base: false,
    type: 'piece',
    subtype: 'fireplace',
    emoji: 'üéÉ',
    tier: 1,
    fireplace: { fuel: 'Resin', capacity: 6, burnTime: 20000, minHeightAbove: 0.76, smoke: false, fireworks: false },
    piece: { target: 'primary', water: undefined, size: [0.5, 0.5, 0.5] },
    wear: wearStructure(200, mods([0, 0, 1, 0, 0, 3, 3, 0, 3, 3]), undefined, { noRoof: false }),
    recipe: { type: 'craft_piece', materials: { Turnip: 4, Resin: 2 }, station: CraftingStation.Workbench },
  },
];

pieces.forEach(p => {
  if (p.subtype === 'craft') {
    craftingStationIds[p.craft.id] = p.id;
  }
});
